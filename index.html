<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyse Géospatiale - Cartographie des espèces d'arbres</title>
    
    <!-- Preload des polices et ressources critiques -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" as="style">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" as="style">
    
    <!-- Inclusion des bibliothèques CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="./css/ol.css">
    <link rel="stylesheet" href="./css/fontawesome-all.min.css">
    <link rel="stylesheet" href="./css/ol-geocoder.min.css">
    <link rel="stylesheet" href="./css/leaflet.css">
    <link rel="stylesheet" href="./css/MarkerCluster.css">
    <link rel="stylesheet" href="./css/MarkerCluster.Default.css">
    <link rel="stylesheet" href="./css/leaflet-measure.css">

    <!-- Styles personnalisés -->
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #e74c3c;
            --accent-color: #3498db;
            --weather-color: #f39c12;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding-top: 70px; /* Compensation pour la navbar fixe */
            position: relative;
        }

        /* Loader */
        .page-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.9);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid var(--accent-color);
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

/* Style de base pour la navbar */
/* Style de base pour la navbar avec une couleur verte */
.navbar {
    background-color: var(--primary-color, #2e7d32); /* Vert forêt par défaut */
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2); /* Ombre légère */
    transition: all 0.3s ease; /* Animation fluide */
    margin-bottom: 0; /* Supprime la marge en bas */
    padding: 10px 0; /* Padding vertical pour l'esthétique */
    border-bottom: none; /* Pas de bordure en bas */
}

/* Style lorsque la navbar est défilée */
.navbar.scrolled {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); /* Ombre plus prononcée */
    background-color: var(--primary-color, #388e3c); /* Vert légèrement plus clair au défilement */
}

/* Adaptation pour les écrans plus petits */
@media (max-width: 768px) {
    .navbar {
        padding: 8px 10px; /* Padding ajusté pour mobile */
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); /* Ombre plus légère */
    }

    .navbar.scrolled {
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1); /* Ombre adaptée pour mobile */
    }
}
/* Styles de la Bannière de Crédits */
.credits-banner {
    background: linear-gradient(90deg, var(--primary-color) 0%, #34495e 100%);
    color: white;
    padding: 12px 0;
    text-align: center;
    font-size: 1rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    margin: 0 !important; /* Supprime toutes les marges */
    margin-top: 0 !important; /* Double protection pour le haut */
}
        .academic-badge {
            background-color: var(--accent-color);
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
            margin-left: 10px;
        }
        
        .hero-section {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('https://images.unsplash.com/photo-1517984825666-0c7d9536e1f9?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 100px 0;
            margin-bottom: 30px;
        }
        
        .methodology-card {
            border-left: 4px solid var(--secondary-color);
            transition: transform 0.3s ease;
            height: 100%;
        }
        
        .methodology-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .tech-logo {
            height: 50px;
            margin-bottom: 15px;
        }
        
        .workflow-diagram {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 30px 0;
        }
        
        /* Styles OpenLayers */
        #map-container {
            width: 100%;
            height: 600px;
            margin: 20px 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .ol-control > * {
            background-color: #f8f8f8!important;
            color: #444444!important;
            border-radius: 0px;
        }
        
        .ol-attribution a, .gcd-gl-input::placeholder, .search-layer-input-search::placeholder {
            color: #444444!important;
        }
        
        .search-layer-input-search {
            background-color: #f8f8f8!important;
        }
        
        .ol-control > *:focus, .ol-control >*:hover {
            background-color: rgba(248, 248, 248, 0.7)!important;
        } 
        
        .ol-control {
            background-color: rgba(255,255,255,.4) !important;
            padding: 2px !important;
        }
        
        .ol-popup {
            position: absolute;
            background-color: white;
            box-shadow: 0 1px 4px rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #cccccc;
            bottom: 12px;
            left: -50px;
            min-width: 280px;
        }
        
        .ol-popup:after, .ol-popup:before {
            top: 100%;
            border: solid transparent;
            content: " ";
            height: 0;
            width: 0;
            position: absolute;
            pointer-events: none;
        }
        
        .ol-popup:after {
            border-top-color: white;
            border-width: 10px;
            left: 48px;
            margin-left: -10px;
        }
        
        .ol-popup:before {
            border-top-color: #cccccc;
            border-width: 11px;
            left: 48px;
            margin-left: -11px;
        }
        
        .ol-popup-closer {
            text-decoration: none;
            position: absolute;
            top: 2px;
            right: 8px;
        }
        
        .ol-popup-closer:after {
            content: "✖";
            color: #444;
        }

        /* Styles NDVI */
        .ndvi-img {
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        
        .ndvi-img:hover {
            transform: scale(1.03);
        }
        #map {
            width: 784px;
            height: 441px;
        }
        .ndvi-legend {
            width: 100%;
            height: 20px;
            background: linear-gradient(to right, #d73027, #fc8d59, #fee08b, #d9ef8b, #91cf60, #1a9850);
            border-radius: 4px;
            margin: 10px 0;
        }
        
        .ndvi-legend-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
        }
        /* Ajoutez ce style pour s'assurer que le sticky fonctionne */
    .navbar {
    position: fixed;
    width: 100%;
    top: 0;
    left: 0;
    z-index: 1030;
}
    </style>
</head>
<body>
    <!-- Barre de navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <i class="bi bi-geo-alt-fill me-2"></i>
                <span>Projet Géomatique</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link active" href="#"><i class="bi bi-binoculars"></i>Carto_Espèces</a></li>
                    <li class="nav-item"><a class="nav-link" href="#hera"><i class="bi bi-map me-1"></i> Cartographie</a></li>
                    <li class="nav-item"><a class="nav-link" href="#methodologie"><i class="bi bi-diagram-3 me-1"></i> Méthodologie</a></li>
                    <li class="nav-item"><a class="nav-link" href="meteo_marseille.html"><i class="bi bi-cloud-sun-fill me-1"></i> Météo Marseille</a></li>
                    <li class="nav-item"><a class="nav-link" href="dash.html"><i class="bi bi-speedometer2 me-2"></i>Dashboard</a></li>
                    <li class="nav-item"><a class="nav-link" href="code.html"><i class="bi bi-code-slash me-1"></i> Code Source</a></li>
                </ul>
            </div>
        </div>
    </nav>
  
    <!-- Bannière des crédits -->
    <div class="credits-banner">
        <div class="container">
            <span>Réalisé par <strong>Ameth Samb</strong> | Sous la direction de <strong>Sébastien Bridier</strong> 
                  <span class="academic-badge">Master Géomatique et Modélisation Spatiale</span></span>
        </div>
    </div>
  
    <!-- Contenu principal -->
<div class="container my-5">
    <!-- Section Hero avec fond thématique -->
    <div class="hero-section rounded-3 text-center p-5 mb-4" style="background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('https://images.unsplash.com/photo-1483728642387-6c3bdd6c93e5?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80') no-repeat center center; background-size: cover; color: white;">
        <h1 class="display-4 fw-bold">Cartographie de la densité des espèces d'arbres</h1>
        <p class="lead">Approche géomatique combinant télédétection et inventaires forestiers</p>
    </div>

    
    <!-- Section Contexte Technique -->
    <section id="contexte-technique" class="my-5">
        <div class="row g-4">
            <div class="col-lg-6">
                <div class="card h-100 shadow-sm">
                    <div class="card-header bg-success text-white">
                        <h3 class="h5 mb-0"><i class="bi bi-camera-fill me-2"></i>Télédétection</h3>
                    </div>
                    <div class="card-body">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">Imagerie multispectrale (Sentinel-2, Landsat)</li>
                            <li class="list-group-item">Indices Spectraux</li>
                            <li class="list-group-item">Classification  supervisée</li>
                            <li class="list-group-item">Classification non supervisée</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="card h-100 shadow-sm">
                    <div class="card-header bg-primary text-white">
                        <h3 class="h5 mb-0"><i class="bi bi-clipboard-data me-2"></i>Inventaires</h3>
                    </div>
                    <div class="card-body">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">Données IFN (Inventaire Forestier National)</li>
                            <li class="list-group-item">Echantillonnage</li>
                            <li class="list-group-item">Stratification écologique</li>
                            <li class="list-group-item">Validation terrain</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    
<!-- Section Méthodologie -->
        <section id="methodologie" class="my-5 py-4">
            <h2 class="text-center mb-5 fw-bold"><i class="bi bi-diagram-3"></i> Méthodologie Technique</h2>
            
            <div class="row g-4 mb-5">
                <!-- Google Earth Engine -->
                
                <!-- Google Colab -->
                <div class="col-md-6 col-lg-4">
                    <div class="card methodology-card h-100">
                        <div class="card-body">
                            <div class="text-center">
                                <img src="https://colab.research.google.com/img/colab_favicon_256px.png" alt="Google Colab" class="tech-logo">
                            </div>
                            <h4 class="card-title text-center">Google Colab</h4>
                            <ul class="list-unstyled">
                                <li><i class="bi bi-check-circle text-success me-2"></i>Traitement des données avec Python</li>
                                <li><i class="bi bi-check-circle text-success me-2"></i>Automatisation des analyses</li>
                                <li><i class="bi bi-check-circle text-success me-2"></i>Génération de statistiques</li>
                                <li><i class="bi bi-check-circle text-success me-2"></i>Visualisation intermédiaire</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- QGIS -->
                <div class="col-md-6 col-lg-4">
                    <div class="card methodology-card h-100">
                        <div class="card-body">
                            <div class="text-center">
                                <img src="https://flathub.org/_next/image?url=https%3A%2F%2Fdl.flathub.org%2Fmedia%2Forg%2Fqgis%2Fqgis.desktop%2F89852566462f997d8603a996310ec8ed%2Ficons%2F128x128%2Forg.qgis.qgis.desktop.png&w=128&q=100" alt="QGIS" class="tech-logo">
                            </div>
                            <h4 class="card-title text-center">QGIS</h4>
                            <ul class="list-unstyled">
                                <li><i class="bi bi-check-circle text-success me-2"></i>Intégration des couches vectorielles</li>
                                <li><i class="bi bi-check-circle text-success me-2"></i>Analyse spatiale avancée</li>
                                <li><i class="bi bi-check-circle text-success me-2"></i>Croisement avec données locales</li>
                                <li><i class="bi bi-check-circle text-success me-2"></i>Préparation des données pour le web</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- QGIS2Web -->
                <div class="col-md-6 col-lg-4">
                    <div class="card methodology-card h-100">
                        <div class="card-body">
                            <div class="text-center">
                                <i class="bi bi-globe2" style="font-size:50px; color:var(--accent-color)"></i>
                            </div>
                            <h4 class="card-title text-center">QGIS2Web</h4>
                            <ul class="list-unstyled">
                                <li><i class="bi bi-check-circle text-success me-2"></i>Export des cartes interactives</li>
                                <li><i class="bi bi-check-circle text-success me-2"></i>Configuration des fonds cartographiques</li>
                                <li><i class="bi bi-check-circle text-success me-2"></i>Création des légendes interactives</li>
                                <li><i class="bi bi-check-circle text-success me-2"></i>Optimisation pour publication web</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>


        <!-- Section Analyse Comparative par Classification -->
<section id="classification-analysis" class="my-5 py-4">
    <h2 class="text-center mb-5 fw-bold"><i class="bi bi-map"></i> Évolution de l'occupation du sol (2014-2024)</h2>
    
    <div class="row g-4 mb-4">
        <!-- Classification Landsat 8 - 2014 -->
        <div class="col-md-4">
            <div class="card h-100">
                <div class="card-header bg-secondary text-white">
                    <h4 class="card-title mb-0 text-center"><i class="bi bi-satellite"></i> Landsat 8 (2014)</h4>
                </div>
                <div class="card-body text-center">
                    <img src="images/classification_2014.jpeg" alt="Classification 2014" class="img-fluid rounded mb-3" style="max-height: 300px;">
                    <div class="px-3">
                        <p class="card-text text-start">
                            <i class="bi bi-check-circle-fill text-success"></i> <strong>Méthode :</strong> Classification K-means (10 classes)<br>
                            <i class="bi bi-check-circle-fill text-success"></i> <strong>Résolution :</strong> 30m<br>
                            <i class="bi bi-check-circle-fill text-success"></i> <strong>Période :</strong> Juillet-Août 2014
                        </p>
                    </div>
                    <div class="mt-auto d-grid gap-2">
                        <button class="btn btn-sm btn-outline-dark" onclick="showSourceCode('landsat2014')">
                            <i class="bi bi-code-slash"></i> Afficher le code
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Classification Sentinel-2 - 2024 -->
        <div class="col-md-4">
            <div class="card h-100">
                <div class="card-header bg-primary text-white">
                    <h4 class="card-title mb-0 text-center"><i class="bi bi-satellite-fill"></i> Sentinel-2 (2024)</h4>
                </div>
                <div class="card-body text-center">
                    <img src="images/classification_2024.jpeg" alt="Classification 2024" class="img-fluid rounded mb-3" style="max-height: 300px;">
                    <div class="px-3">
                        <p class="card-text text-start">
                            <i class="bi bi-check-circle-fill text-primary"></i> <strong>Méthode :</strong> Classification K-means (10 classes)<br>
                            <i class="bi bi-check-circle-fill text-primary"></i> <strong>Résolution :</strong> 10m/20m<br>
                            <i class="bi bi-check-circle-fill text-primary"></i> <strong>Période :</strong> Juillet-Août 2024
                        </p>
                    </div>
                    <div class="mt-auto d-grid gap-2">
                        <button class="btn btn-sm btn-outline-dark" onclick="showSourceCode('sentinel2024')">
                            <i class="bi bi-code-slash"></i> Afficher le code
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Analyse Comparative -->
        <div class="col-md-4">
            <div class="card h-100">
                <div class="card-header bg-success text-white">
                    <h4 class="card-title mb-0 text-center"><i class="bi bi-arrow-left-right"></i> Analyse Comparative</h4>
                </div>
                <div class="card-body text-center">
                    <img src="images/change.JPG" alt="Différence 2014-2024" class="img-fluid rounded mb-3" style="max-height: 300px;">
                    <div class="px-3">
                        <p class="card-text text-start">
                            <i class="bi bi-check-circle-fill text-secondary"></i> <strong>Zones stables :</strong> 65% de la superficie<br>
                            <i class="bi bi-arrow-up-circle-fill text-success"></i> <strong>Régénération :</strong> 22%<br>
                            <i class="bi bi-arrow-down-circle-fill text-danger"></i> <strong>Dégradation :</strong> 13%
                        </p>
                    </div>
                    <div class="mt-auto d-grid gap-2">
                        <button class="btn btn-sm btn-outline-dark" onclick="showSourceCode('comparison')">
                            <i class="bi bi-code-slash"></i> Code Source
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
        <!-- Section NDVI -->
        <section id="ndvi-analysis" class="my-5 py-4">
            <h2 class="text-center mb-5 fw-bold"><i class="bi bi-tree"></i> Analyse NDVI des espèces d'arbres</h2>
            
            <div class="row g-4 mb-4">
                <!-- NDVI 2004 -->
                <div class="col-md-4">
                    <div class="card h-100">
                        <div class="card-header bg-primary text-white">
                            <h4 class="card-title mb-0 text-center"><i class="bi bi-calendar"></i> NDVI 2004</h4>
                        </div>
                        <div class="card-body text-center">
                            <img src="images/ndvi_2024_20250508_164016.jpg" alt="NDVI 2004" class="img-fluid rounded mb-3 ndvi-img" style="max-height: 300px;">
                            <p class="card-text">Indice de végétation normalisé (NDVI) calculé pour l'année 2004 montrant la couverture végétale avant les changements récents.</p>
                            <div class="ndvi-legend"></div>
                            <div class="ndvi-legend-labels">
                                <span>-1</span>
                                <span>0</span>
                                <span>+1</span>
                            </div>
                            <div class="mt-3">
                                <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#ndvi2004Modal">
                                    <i class="bi bi-zoom-in"></i> Voir en détail
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- NDVI 2024 -->
                <div class="col-md-4">
                    <div class="card h-100">
                        <div class="card-header bg-success text-white">
                            <h4 class="card-title mb-0 text-center"><i class="bi bi-calendar-check"></i> NDVI 2024</h4>
                        </div>
                        <div class="card-body text-center">
                            <img src="images/ndvi_2004_20250508_164016.jpg" alt="NDVI 2024" class="img-fluid rounded mb-3 ndvi-img" style="max-height: 300px;">
                            <p class="card-text">Indice de végétation normalisé (NDVI) calculé pour l'année 2024 montrant l'état actuel de la couverture végétale.</p>
                            <div class="ndvi-legend"></div>
                            <div class="ndvi-legend-labels">
                                <span>-1</span>
                                <span>0</span>
                                <span>+1</span>
                            </div>
                            <div class="mt-3">
                                <button class="btn btn-sm btn-outline-success" data-bs-toggle="modal" data-bs-target="#ndvi2024Modal">
                                    <i class="bi bi-zoom-in"></i> Voir en détail
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- NDVI Différence -->
                <div class="col-md-4">
                    <div class="card h-100">
                        <div class="card-header bg-warning text-dark">
                            <h4 class="card-title mb-0 text-center"><i class="bi bi-arrow-left-right"></i> Différence NDVI</h4>
                        </div>
                        <div class="card-body text-center">
                            <img src="images/ndvi_diff_20250508_164016.jpg" alt="Différence NDVI" class="img-fluid rounded mb-3 ndvi-img" style="max-height: 300px;">
                            <p class="card-text">Différence entre les indices NDVI de 2024 et 2004, montrant l'évolution de la végétation sur 20 ans.</p>
                            <div class="ndvi-legend"></div>
                            <div class="ndvi-legend-labels">
                                <span>Dégradation</span>
                                <span>Stable</span>
                                <span>Amélioration</span>
                            </div>
                            <div class="mt-3">
                                <button class="btn btn-sm btn-outline-warning" data-bs-toggle="modal" data-bs-target="#ndviDiffModal">
                                    <i class="bi bi-zoom-in"></i> Voir en détail
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-12">
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle-fill me-2"></i>
                        <strong>Note méthodologique :</strong> Les images NDVI ont été calculées à partir d'images satellites Sentinel-2 avec une résolution spatiale de 10m. La différence NDVI montre les zones où la végétation s'est améliorée (valeurs positives) ou dégradée (valeurs négatives) entre 2004 et 2024.
                    </div>
                </div>
            </div>
        </section>

              <!-- Section Carte Classifiée -->
        <section id="classified-map" class="my-5 py-4">
            <h2 class="text-center mb-5 fw-bold"><i class="bi bi-map"></i> Carte Classifiée des Espèces Végétales</h2>
            
            <div class="row">
                <div class="col-md-8 mx-auto">
                    <div class="card">
                        <div class="card-header bg-secondary text-white d-flex justify-content-between align-items-center">
                            <h4 class="card-title mb-0"><i class="bi bi-tree-fill"></i> Répartition des Espèces d'Arbres</h4>
                            <div>
                                <a href="code.html" class="btn btn-sm btn-light" target="_blank">
                                    <i class="bi bi-code-slash me-1"></i> Accéder au code
                                </a>
                            </div>
                        </div>
                        <div class="card-body">
                            <!-- Image cliquable avec data-bs-toggle pour le modal -->
                            <img src="images/inventaire.JPG" alt="Carte classifiée des espèces végétales" 
                                 class="img-fluid rounded mb-3 cursor-zoom" 
                                 data-bs-toggle="modal" data-bs-target="#imageZoomModal"
                                 style="cursor: pointer;">
                            
                            <div class="row mt-4">
                                <div class="col-md-6">
                                    <h5 class="fw-bold"><i class="bi bi-list-ul"></i> Légende des Espèces</h5>
                                    <ul class="list-group">
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            Chêne vert
                                            <span class=""></span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            Pin brutta
                                            <span class=""></span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            Chêne pubescent
                                            <span class=""></span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            Frêne oxyphylle
                                            <span class=""></span>
                                        </li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h5 class="fw-bold"><i class=""></i> Autres Couches</h5>
                                    <ul class="list-group">
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            Habitat
                                            <span class=""></span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            Hydrographie
                                            <span class=""></span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            Sol nu/Surface agricole
                                            <span class=""></span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="mt-4 text-center">
                                <a href="code.html">
                                    <i class="bi bi-file-earmark-code"></i> Code source</a>
                            </div>
                        </div>
                        <div class="card-footer text-muted small">
                            <i class="bi bi-geo-alt-fill"></i> Échelle: 0-20 km | Source: COPERNICUS S2_SR, COPERNICUS S1_GRD
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row mt-4">
                <div class="col-12">
                    <div class="alert alert-success">
                        <i class="bi bi-lightbulb-fill me-2"></i>
                        <strong>Analyse :</strong> Cette carte classifiée montre la répartition spatiale des principales espèces arboricoles de la région. On observe une dominance du Chêne vert en zones sèches, tandis que le Frêne oxyphylle se concentre près des cours d'eau. Les Pins brutta occupent principalement les zones montagneuses.
                    </div>
                </div>
            </div>
        </section>

        <!-- Modal pour l'agrandissement de l'image -->
        <div class="modal fade" id="imageZoomModal" tabindex="-1" aria-labelledby="imageZoomModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-xl modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="imageZoomModalLabel">Carte classifiée - Vue détaillée</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body text-center">
                        <img src="images/inventaire.jpeg" class="img-fluid" alt="Carte agrandie">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                            <i class="bi bi-x-lg"></i> Fermer
                        </button>
                        <a href="images/inventaire.jpeg" download="carte_especes_vegetales.jpeg" class="btn btn-primary">
                            <i class="bi bi-download"></i> Télécharger
                        </a>
                    </div>
                </div>
            </div>
        </div> 

        <!-- Section Carte -->
        <section id="hera" class="my-5">
            <h2 class="text-center mb-4"><i class="bi bi-map me-2"></i> Cartographie Interactive</h2>
            <div class="row">
                <div class="col-12">
                    <div id="map-container">
                        <div id="map">
                            <div id="popup" class="ol-popup">
                                <a href="#" id="popup-closer" class="ol-popup-closer"></a>
                                <div id="popup-content"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Workflow -->
        <div class="workflow-diagram">
            <h4 class="text-center mb-4">
                <i class="bi bi-arrow-repeat"></i> Workflow d'analyse
            </h4>
            <div class="text-center"></div>
        </div>
    </div>

    <!-- Modals NDVI -->
    <!-- Modal NDVI 2004 -->
    <div class="modal fade" id="ndvi2004Modal" tabindex="-1" aria-labelledby="ndvi2004ModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="ndvi2004ModalLabel"><i class="bi bi-calendar"></i> NDVI 2004 - Détail</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-8">
                            <img src="images/ndvi_2014.JPG" alt="NDVI 2004" class="img-fluid rounded">
                        </div>
                        <div class="col-md-4">
                            <h5>Interprétation</h5>
                            <p>L'image NDVI de 2004 montre la santé de la végétation avant les changements récents. Les valeurs vont de -1 à +1 :</p>
                            <ul>
                                <li><strong>Valeurs positives élevées</strong> : Végétation dense et en bonne santé</li>
                                <li><strong>Valeurs positives faibles</strong> : Végétation clairsemée ou stressée</li>
                                <li><strong>Valeurs proches de zéro</strong> : Sol nu ou zones urbaines</li>
                                <li><strong>Valeurs négatives</strong> : Eau ou neige</li>
                            </ul>
                            <div class="ndvi-legend"></div>
                            <div class="ndvi-legend-labels">
                                <span>-1</span>
                                <span>0</span>
                                <span>+1</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal NDVI 2024 -->
    <div class="modal fade" id="ndvi2024Modal" tabindex="-1" aria-labelledby="ndvi2024ModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="ndvi2024ModalLabel"><i class="bi bi-calendar-check"></i> NDVI 2024 - Détail</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-8">
                            <img src="images/ndvi_2024.JPG" alt="NDVI 2024" class="img-fluid rounded">
                        </div>
                        <div class="col-md-4">
                            <h5>Interprétation</h5>
                            <p>L'image NDVI de 2024 montre l'état actuel de la végétation. Comparée à 2004, on peut observer :</p>
                            <ul>
                                <li><strong>Zones de régénération</strong> : Augmentation du NDVI</li>
                                <li><strong>Zones dégradées</strong> : Diminution du NDVI</li>
                                <li><strong>Changements d'occupation du sol</strong> : Urbanisation ou déforestation</li>
                                
                            </ul>
                            <div class="ndvi-legend"></div>
                            <div class="ndvi-legend-labels">
                                <span>-1</span>
                                <span>0</span>
                                <span>+1</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal NDVI Différence -->
    <div class="modal fade" id="ndviDiffModal" tabindex="-1" aria-labelledby="ndviDiffModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-warning text-dark">
                    <h5 class="modal-title" id="ndviDiffModalLabel"><i class="bi bi-arrow-left-right"></i> Différence NDVI - Détail</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-8">
                            <img src="images/ndvi_diff.JPG" alt="Différence NDVI" class="img-fluid rounded">
                        </div>
                        <div class="col-md-4">
                            <h5>Interprétation</h5>
                            <p>La différence NDVI (2024 - 2004) montre l'évolution de la végétation sur 20 ans :</p>
                            <ul>
                                <li><strong>Valeurs positives</strong> : Amélioration de la végétation (reboisement, croissance)</li>
                                <li><strong>Valeurs proches de zéro</strong> : Peu ou pas de changement</li>
                                <li><strong>Valeurs négatives</strong> : Dégradation de la végétation (incendies, déforestation)</li>
                                <li><strong>Zones rouges</strong> : Perte importante de végétation</li>
                                <li><strong>Zones vertes</strong> : Gain important de végétation</li>
                            </ul>
                            <div class="ndvi-legend"></div>
                            <div class="ndvi-legend-labels">
                                <span>Dégradation</span>
                                <span>Stable</span>
                                <span>Amélioration</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                </div>
            </div>
        </div>
    </div>
<footer class="bg-dark text-white pt-5 pb-4">
    <div class="container">
        <div class="row">
            <!-- Informations étudiantes -->
            <div class="col-lg-4 mb-4">
                <h5 class="text-uppercase mb-4" style="color: var(--accent-color);">
                    <i class="bi bi-person-badge"></i> Informations étudiantes
                </h5>
                <div class="d-flex align-items-start mb-3">
                    <i class="bi bi-mortarboard fs-4 me-3" style="color: var(--accent-color);"></i>
                    <div>
                        <h6 class="mb-0">Ameth Samb</h6>
                        <p class="small mb-0">Master Géomatique et Modélisation Spatiale</p>
                        <p class="small text-muted">Promotion 2024-2025</p>
                    </div>
                </div>
                <div class="d-flex align-items-start">
                    <i class="bi bi-geo-alt fs-4 me-3" style="color: var(--accent-color);"></i>
                    <div>
                        <h6 class="mb-0">Localisation</h6>
                        <p class="small mb-0">Marseille, France</p>
                        <p class="small text-muted">Aix-Marseille Université</p>
                    </div>
                </div>
            </div>

            <!-- Carte de localisation -->
            <div class="col-lg-4 mb-4">
                <h5 class="text-uppercase mb-4" style="color: var(--accent-color);">
                    <i class="bi bi-geo"></i> Localisation Marseille
                </h5>
                <div class="ratio ratio-16x9">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d185912.72405217227!2d5.24084475!3d43.2803051!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x12c9bf4344da5333%3A0x40819a5fd970220!2sMarseille!5e0!3m2!1sfr!2sfr!4v1715870000000!5m2!1sfr!2sfr" 
                            style="border:0; border-radius: 8px;" 
                            allowfullscreen="" 
                            loading="lazy" 
                            referrerpolicy="no-referrer-when-downgrade">
                    </iframe>
                </div>
            </div>

            <!-- Contact et réseaux -->
            <div class="col-lg-4 mb-4">
                <h5 class="text-uppercase mb-4" style="color: var(--accent-color);">
                    <i class="bi bi-send"></i> Contact
                </h5>
                <ul class="list-unstyled">
                    <li class="mb-3">
                        <a href="mailto:ameth.samb@etu.univ-amu.fr" class="text-white text-decoration-none">
                            <i class="bi bi-envelope me-2"></i> ameth.samb@etu.univ-amu.fr
                        </a>
                    </li>
                    <li>
                        <a href="https://formations.univ-amu.fr/fr/master-geomatique-et-modelisation-spatiale" 
                           class="text-white text-decoration-none" target="_blank">
                            <i class="bi bi-book me-2"></i> Formation Master Géomatique
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <hr class="my-4" style="border-color: rgba(255,255,255,0.1);">

        <!-- Copyright -->
        <div class="row">
            <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                <p class="small mb-0">
                    &copy; 2024 Ameth Samb - Travail académique Master Géomatique
                </p>
            </div>
            <div class="col-md-6 text-center text-md-end">
                <a href="#top" class="text-white small me-3">
                    <i class="bi bi-arrow-up-circle me-1"></i> Retour en haut
                </a>
                <a href="#" class="text-white small me-3">Mentions légales</a>
                <a href="#" class="text-white small">Confidentialité</a>
            </div>
        </div>
    </div>
</footer>
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="resources/qgis2web_expressions.js"></script>
    <script src="resources/proj4.js"></script>
    <script>proj4.defs('EPSG:2154','+proj=lcc +lat_0=46.5 +lon_0=3 +lat_1=49 +lat_2=44 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs');</script>
    <script src="./resources/functions.js"></script>
    <script src="./resources/ol.js"></script>
    <script src="./resources/ol-layerswitcher.js"></script>
    <script src="resources/ol-geocoder.js"></script>
    <script src="layers/BouchesduRhne_2.js"></script>
    <script src="layers/Territoires_3.js"></script>
    <script src="layers/Limitecommune_4.js"></script>
    <script src="layers/Donnees_inventaires_5.js"></script>
    <script src="styles/BouchesduRhne_2_style.js"></script>
    <script src="styles/Territoires_3_style.js"></script>
    <script src="styles/Limitecommune_4_style.js"></script>
    <script src="styles/Donnees_inventaires_5_style.js"></script>
    <script src="./layers/layers.js" type="text/javascript"></script> 
    <script src="./resources/Autolinker.min.js"></script>
    <script src="./resources/qgis2web.js"></script>
    
    <script>
        // Ajustement de la taille de la carte après le chargement
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                var mapElement = document.getElementById('map');
                if(mapElement) {
                    mapElement.style.width = '100%';
                    mapElement.style.height = '100%';
                }
            }, 500);
        });
    </script>
        <script src="js/qgis2web_expressions.js"></script>
        <script src="js/leaflet.js"></script>
        <script src="js/leaflet.rotatedMarker.js"></script>
        <script src="js/leaflet.pattern.js"></script>
        <script src="js/leaflet-hash.js"></script>
        <script src="js/Autolinker.min.js"></script>
        <script src="js/rbush.min.js"></script>
        <script src="js/labelgun.min.js"></script>
        <script src="js/labels.js"></script>
        <script src="js/leaflet-measure.js"></script>
        <script src="js/leaflet.markercluster.js"></script>
        <script src="data/Arrondissement_2.js"></script>
        <script src="data/Commune_3.js"></script>
        <script src="data/Bouchesdurhne_4.js"></script>
        <script src="data/Placette_5.js"></script>
        <script>
        var highlightLayer;
        function highlightFeature(e) {
            highlightLayer = e.target;
            highlightLayer.openPopup();
        }
        var map = L.map('map', {
            zoomControl:true, maxZoom:28, minZoom:1
        }).fitBounds([[43.11142580264339,3.982585083425831],[43.99840573950427,6.090276565138013]]);
        var hash = new L.Hash(map);
        map.attributionControl.setPrefix('<a href="https://github.com/tomchadwin/qgis2web" target="_blank">qgis2web</a> &middot; <a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> &middot; <a href="https://qgis.org">QGIS</a>');
        var autolinker = new Autolinker({truncate: {length: 30, location: 'smart'}});
        var measureControl = new L.Control.Measure({
            position: 'topleft',
            primaryLengthUnit: 'meters',
            secondaryLengthUnit: 'kilometers',
            primaryAreaUnit: 'sqmeters',
            secondaryAreaUnit: 'hectares'
        });
        measureControl.addTo(map);
        document.getElementsByClassName('leaflet-control-measure-toggle')[0]
        .innerHTML = '';
        document.getElementsByClassName('leaflet-control-measure-toggle')[0]
        .className += ' fas fa-ruler';
        var bounds_group = new L.featureGroup([]);
        function setBounds() {
        }
        map.createPane('pane_OpenStreetMap_0');
        map.getPane('pane_OpenStreetMap_0').style.zIndex = 400;
        var layer_OpenStreetMap_0 = L.tileLayer('http://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            pane: 'pane_OpenStreetMap_0',
            opacity: 1.0,
            attribution: '',
            minZoom: 1,
            maxZoom: 28,
            minNativeZoom: 0,
            maxNativeZoom: 18
        });
        layer_OpenStreetMap_0;
        map.addLayer(layer_OpenStreetMap_0);
        map.createPane('pane_EsriOcean_1');
        map.getPane('pane_EsriOcean_1').style.zIndex = 401;
        var layer_EsriOcean_1 = L.tileLayer('https://services.arcgisonline.com/ArcGIS/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}', {
            pane: 'pane_EsriOcean_1',
            opacity: 1.0,
            attribution: '',
            minZoom: 1,
            maxZoom: 28,
            minNativeZoom: 0,
            maxNativeZoom: 10
        });
        layer_EsriOcean_1;
        map.addLayer(layer_EsriOcean_1);
        function pop_Arrondissement_2(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    if (typeof layer.closePopup == 'function') {
                        layer.closePopup();
                    } else {
                        layer.eachLayer(function(feature){
                            feature.closePopup()
                        });
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ID'] !== null ? autolinker.link(feature.properties['ID'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['NOM'] !== null ? autolinker.link(feature.properties['NOM'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['INSEE_ARR'] !== null ? autolinker.link(feature.properties['INSEE_ARR'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['INSEE_DEP'] !== null ? autolinker.link(feature.properties['INSEE_DEP'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['INSEE_REG'] !== null ? autolinker.link(feature.properties['INSEE_REG'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ID_AUT_ADM'] !== null ? autolinker.link(feature.properties['ID_AUT_ADM'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DATE_CREAT'] !== null ? autolinker.link(feature.properties['DATE_CREAT'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DATE_MAJ'] !== null ? autolinker.link(feature.properties['DATE_MAJ'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DATE_APP'] !== null ? autolinker.link(feature.properties['DATE_APP'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DATE_CONF'] !== null ? autolinker.link(feature.properties['DATE_CONF'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            layer.bindPopup(popupContent, {maxHeight: 400});
        }

        function style_Arrondissement_2_0(feature) {
            switch(String(feature.properties['NOM'])) {
                case 'Aix-en-Provence':
                    return {
                pane: 'pane_Arrondissement_2',
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(166,248,65,1.0)',
                interactive: true,
            }
                    break;
                case 'Arles':
                    return {
                pane: 'pane_Arrondissement_2',
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(255,107,122,1.0)',
                interactive: true,
            }
                    break;
                case 'Istres':
                    return {
                pane: 'pane_Arrondissement_2',
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(205,242,255,1.0)',
                interactive: true,
            }
                    break;
                case 'Marseille':
                    return {
                pane: 'pane_Arrondissement_2',
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(245,255,149,1.0)',
                interactive: true,
            }
                    break;
            }
        }
        map.createPane('pane_Arrondissement_2');
        map.getPane('pane_Arrondissement_2').style.zIndex = 402;
        map.getPane('pane_Arrondissement_2').style['mix-blend-mode'] = 'normal';
        var layer_Arrondissement_2 = new L.geoJson(json_Arrondissement_2, {
            attribution: '',
            interactive: true,
            dataVar: 'json_Arrondissement_2',
            layerName: 'layer_Arrondissement_2',
            pane: 'pane_Arrondissement_2',
            onEachFeature: pop_Arrondissement_2,
            style: style_Arrondissement_2_0,
        });
        bounds_group.addLayer(layer_Arrondissement_2);
        map.addLayer(layer_Arrondissement_2);
        function pop_Commune_3(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    if (typeof layer.closePopup == 'function') {
                        layer.closePopup();
                    } else {
                        layer.eachLayer(function(feature){
                            feature.closePopup()
                        });
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ID'] !== null ? autolinker.link(feature.properties['ID'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['INSEE_COM'] !== null ? autolinker.link(feature.properties['INSEE_COM'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['INSEE_ARR'] !== null ? autolinker.link(feature.properties['INSEE_ARR'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['INSEE_COL'] !== null ? autolinker.link(feature.properties['INSEE_COL'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['INSEE_DEP'] !== null ? autolinker.link(feature.properties['INSEE_DEP'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['INSEE_REG'] !== null ? autolinker.link(feature.properties['INSEE_REG'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['POPULATION'] !== null ? autolinker.link(feature.properties['POPULATION'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['SURFACE_HA'] !== null ? autolinker.link(feature.properties['SURFACE_HA'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DATE_CREAT'] !== null ? autolinker.link(feature.properties['DATE_CREAT'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DATE_MAJ'] !== null ? autolinker.link(feature.properties['DATE_MAJ'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DATE_APP'] !== null ? autolinker.link(feature.properties['DATE_APP'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DATE_CONF'] !== null ? autolinker.link(feature.properties['DATE_CONF'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['CODE_POST'] !== null ? autolinker.link(feature.properties['CODE_POST'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['NOM'] !== null ? autolinker.link(feature.properties['NOM'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['CL_ARROND'] !== null ? autolinker.link(feature.properties['CL_ARROND'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['CL_COLLTER'] !== null ? autolinker.link(feature.properties['CL_COLLTER'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['CL_DEPART'] !== null ? autolinker.link(feature.properties['CL_DEPART'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['CL_REGION'] !== null ? autolinker.link(feature.properties['CL_REGION'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['CAPITALE'] !== null ? autolinker.link(feature.properties['CAPITALE'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DATE_RCT'] !== null ? autolinker.link(feature.properties['DATE_RCT'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['RECENSEUR'] !== null ? autolinker.link(feature.properties['RECENSEUR'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['SIREN_EPCI'] !== null ? autolinker.link(feature.properties['SIREN_EPCI'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ID_CH_LIEU'] !== null ? autolinker.link(feature.properties['ID_CH_LIEU'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ID_AUT_ADM'] !== null ? autolinker.link(feature.properties['ID_AUT_ADM'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['CODE_SIREN'] !== null ? autolinker.link(feature.properties['CODE_SIREN'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            layer.bindPopup(popupContent, {maxHeight: 400});
        }

        function style_Commune_3_0() {
            return {
                pane: 'pane_Commune_3',
                opacity: 1,
                color: 'rgba(210,210,210,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(210,210,210,0.0)',
                interactive: true,
            }
        }
        map.createPane('pane_Commune_3');
        map.getPane('pane_Commune_3').style.zIndex = 403;
        map.getPane('pane_Commune_3').style['mix-blend-mode'] = 'normal';
        var layer_Commune_3 = new L.geoJson(json_Commune_3, {
            attribution: '',
            interactive: true,
            dataVar: 'json_Commune_3',
            layerName: 'layer_Commune_3',
            pane: 'pane_Commune_3',
            onEachFeature: pop_Commune_3,
            style: style_Commune_3_0,
        });
        bounds_group.addLayer(layer_Commune_3);
        map.addLayer(layer_Commune_3);
        function pop_Bouchesdurhne_4(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    if (typeof layer.closePopup == 'function') {
                        layer.closePopup();
                    } else {
                        layer.eachLayer(function(feature){
                            feature.closePopup()
                        });
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ID'] !== null ? autolinker.link(feature.properties['ID'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['INSEE_DEP'] !== null ? autolinker.link(feature.properties['INSEE_DEP'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['INSEE_REG'] !== null ? autolinker.link(feature.properties['INSEE_REG'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['NOM'] !== null ? autolinker.link(feature.properties['NOM'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DATE_CREAT'] !== null ? autolinker.link(feature.properties['DATE_CREAT'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DATE_MAJ'] !== null ? autolinker.link(feature.properties['DATE_MAJ'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DATE_APP'] !== null ? autolinker.link(feature.properties['DATE_APP'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DATE_CONF'] !== null ? autolinker.link(feature.properties['DATE_CONF'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ID_AUT_ADM'] !== null ? autolinker.link(feature.properties['ID_AUT_ADM'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['CODE_SIREN'] !== null ? autolinker.link(feature.properties['CODE_SIREN'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            layer.bindPopup(popupContent, {maxHeight: 400});
        }

        function style_Bouchesdurhne_4_0() {
            return {
                pane: 'pane_Bouchesdurhne_4',
                opacity: 1,
                color: 'rgba(255,29,29,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 2.0, 
                fillOpacity: 0,
                interactive: true,
            }
        }
        map.createPane('pane_Bouchesdurhne_4');
        map.getPane('pane_Bouchesdurhne_4').style.zIndex = 404;
        map.getPane('pane_Bouchesdurhne_4').style['mix-blend-mode'] = 'normal';
        var layer_Bouchesdurhne_4 = new L.geoJson(json_Bouchesdurhne_4, {
            attribution: '',
            interactive: true,
            dataVar: 'json_Bouchesdurhne_4',
            layerName: 'layer_Bouchesdurhne_4',
            pane: 'pane_Bouchesdurhne_4',
            onEachFeature: pop_Bouchesdurhne_4,
            style: style_Bouchesdurhne_4_0,
        });
        bounds_group.addLayer(layer_Bouchesdurhne_4);
        map.addLayer(layer_Bouchesdurhne_4);
        function pop_Placette_5(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    if (typeof layer.closePopup == 'function') {
                        layer.closePopup();
                    } else {
                        layer.eachLayer(function(feature){
                            feature.closePopup()
                        });
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['CAMPAGNE'] !== null ? autolinker.link(feature.properties['CAMPAGNE'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['VISITE'] !== null ? autolinker.link(feature.properties['VISITE'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['IDP'] !== null ? autolinker.link(feature.properties['IDP'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['XL'] !== null ? autolinker.link(feature.properties['XL'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['YL'] !== null ? autolinker.link(feature.properties['YL'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DEP'] !== null ? autolinker.link(feature.properties['DEP'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['SER'] !== null ? autolinker.link(feature.properties['SER'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DPYR'] !== null ? autolinker.link(feature.properties['DPYR'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ANPYR'] !== null ? autolinker.link(feature.properties['ANPYR'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['PBUIS'] !== null ? autolinker.link(feature.properties['PBUIS'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['NINCID'] !== null ? autolinker.link(feature.properties['NINCID'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['INCID'] !== null ? autolinker.link(feature.properties['INCID'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DIST'] !== null ? autolinker.link(feature.properties['DIST'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ACCES'] !== null ? autolinker.link(feature.properties['ACCES'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ITI'] !== null ? autolinker.link(feature.properties['ITI'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ASPERITE'] !== null ? autolinker.link(feature.properties['ASPERITE'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['PENTEXP'] !== null ? autolinker.link(feature.properties['PENTEXP'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['PORTN'] !== null ? autolinker.link(feature.properties['PORTN'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['PORTANCE'] !== null ? autolinker.link(feature.properties['PORTANCE'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ORNIERE'] !== null ? autolinker.link(feature.properties['ORNIERE'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['GEST'] !== null ? autolinker.link(feature.properties['GEST'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ELAG'] !== null ? autolinker.link(feature.properties['ELAG'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['PRELEV5'] !== null ? autolinker.link(feature.properties['PRELEV5'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DEF5'] !== null ? autolinker.link(feature.properties['DEF5'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DCESPAR1'] !== null ? autolinker.link(feature.properties['DCESPAR1'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DCESPAR2'] !== null ? autolinker.link(feature.properties['DCESPAR2'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['INSTP5'] !== null ? autolinker.link(feature.properties['INSTP5'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['TPESPAR1'] !== null ? autolinker.link(feature.properties['TPESPAR1'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['TPESPAR2'] !== null ? autolinker.link(feature.properties['TPESPAR2'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['TPLANT'] !== null ? autolinker.link(feature.properties['TPLANT'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['BPLANT'] !== null ? autolinker.link(feature.properties['BPLANT'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['IPLANT'] !== null ? autolinker.link(feature.properties['IPLANT'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['VIDEPLANT'] !== null ? autolinker.link(feature.properties['VIDEPLANT'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ENTP'] !== null ? autolinker.link(feature.properties['ENTP'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['VIDEPEUPLIER'] !== null ? autolinker.link(feature.properties['VIDEPEUPLIER'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['TCAT10'] !== null ? autolinker.link(feature.properties['TCAT10'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['CSA'] !== null ? autolinker.link(feature.properties['CSA'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['BOIS'] !== null ? autolinker.link(feature.properties['BOIS'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['PEUPNR'] !== null ? autolinker.link(feature.properties['PEUPNR'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['UTA1'] !== null ? autolinker.link(feature.properties['UTA1'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['UTA2'] !== null ? autolinker.link(feature.properties['UTA2'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['UTIP'] !== null ? autolinker.link(feature.properties['UTIP'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['AUTUT'] !== null ? autolinker.link(feature.properties['AUTUT'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['PLISI'] !== null ? autolinker.link(feature.properties['PLISI'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['CSLISI'] !== null ? autolinker.link(feature.properties['CSLISI'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ELISI'] !== null ? autolinker.link(feature.properties['ELISI'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['NLISI5'] !== null ? autolinker.link(feature.properties['NLISI5'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['ANDAIN'] !== null ? autolinker.link(feature.properties['ANDAIN'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['BORD'] !== null ? autolinker.link(feature.properties['BORD'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['INTEGR'] !== null ? autolinker.link(feature.properties['INTEGR'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['TM2'] !== null ? autolinker.link(feature.properties['TM2'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['TFORM'] !== null ? autolinker.link(feature.properties['TFORM'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['SVER'] !== null ? autolinker.link(feature.properties['SVER'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['SFO'] !== null ? autolinker.link(feature.properties['SFO'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['CAM'] !== null ? autolinker.link(feature.properties['CAM'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['DC'] !== null ? autolinker.link(feature.properties['DC'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['field_57'] !== null ? autolinker.link(feature.properties['field_57'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            layer.bindPopup(popupContent, {maxHeight: 400});
        }

        function style_Placette_5_0() {
            return {
                pane: 'pane_Placette_5',
                radius: 3.2,
                opacity: 1,
                color: 'rgba(181,57,57,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1,
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(190,207,80,1.0)',
                interactive: true,
            }
        }
        map.createPane('pane_Placette_5');
        map.getPane('pane_Placette_5').style.zIndex = 405;
        map.getPane('pane_Placette_5').style['mix-blend-mode'] = 'normal';
        var layer_Placette_5 = new L.geoJson(json_Placette_5, {
            attribution: '',
            interactive: true,
            dataVar: 'json_Placette_5',
            layerName: 'layer_Placette_5',
            pane: 'pane_Placette_5',
            onEachFeature: pop_Placette_5,
            pointToLayer: function (feature, latlng) {
                var context = {
                    feature: feature,
                    variables: {}
                };
                return L.circleMarker(latlng, style_Placette_5_0(feature));
            },
        });
        var cluster_Placette_5 = new L.MarkerClusterGroup({showCoverageOnHover: false,
            spiderfyDistanceMultiplier: 2});
        cluster_Placette_5.addLayer(layer_Placette_5);

        bounds_group.addLayer(layer_Placette_5);
        cluster_Placette_5.addTo(map);
        var baseMaps = {};
        L.control.layers(baseMaps,{'<img src="legend/Placette_5.png" /> Placette': cluster_Placette_5,'<img src="legend/Bouchesdurhne_4.png" /> Bouches du rhône': layer_Bouchesdurhne_4,'<img src="legend/Commune_3.png" /> Commune': layer_Commune_3,'Arrondissement<br /><table><tr><td style="text-align: center;"><img src="legend/Arrondissement_2_AixenProvence0.png" /></td><td>Aix-en-Provence</td></tr><tr><td style="text-align: center;"><img src="legend/Arrondissement_2_Arles1.png" /></td><td>Arles</td></tr><tr><td style="text-align: center;"><img src="legend/Arrondissement_2_Istres2.png" /></td><td>Istres</td></tr><tr><td style="text-align: center;"><img src="legend/Arrondissement_2_Marseille3.png" /></td><td>Marseille</td></tr></table>': layer_Arrondissement_2,"Esri Ocean": layer_EsriOcean_1,"OpenStreetMap": layer_OpenStreetMap_0,},{collapsed:false}).addTo(map);
        setBounds();
        var i = 0;
        layer_Arrondissement_2.eachLayer(function(layer) {
            var context = {
                feature: layer.feature,
                variables: {}
            };
            layer.bindTooltip((layer.feature.properties['NOM'] !== null?String('<div style="color: #000000; font-size: 10pt; font-family: \'Times New Roman\', sans-serif;">' + layer.feature.properties['NOM']) + '</div>':''), {permanent: true, offset: [-0, -16], className: 'css_Arrondissement_2'});
            labels.push(layer);
            totalMarkers += 1;
              layer.added = true;
              addLabel(layer, i);
              i++;
        });
        resetLabels([layer_Arrondissement_2,layer_Commune_3,layer_Placette_5]);
        map.on("zoomend", function(){
            resetLabels([layer_Arrondissement_2,layer_Commune_3,layer_Placette_5]);
        });
        map.on("layeradd", function(){
            resetLabels([layer_Arrondissement_2,layer_Commune_3,layer_Placette_5]);
        });
        map.on("layerremove", function(){
            resetLabels([layer_Arrondissement_2,layer_Commune_3,layer_Placette_5]);
        });
        </script>
</body>
</html>